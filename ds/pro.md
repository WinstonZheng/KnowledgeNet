# 进程
## 相关知识
- MMU：Memory Management Unit，内存管理单元，中央处理器（CPU）中用来管理虚拟存储器、物理存储器的控制线路，同时也负责虚拟地址映射为物理地址，以及提供硬件机制的内存访问授权，多用户多进程操作系统。
- TLB：Translation Lookaside Buffer,页表缓存、转址旁路缓存，CPU的一种缓存，由内存管理单元用于改进虚拟地址到物理地址的转译速度。TLB具有固定数目的空间槽，用于存放将虚拟地址映射至物理地址的标签页表条目。
## 进程与线程
为多进程提供硬件并发透明性代价很大：
1. 分配完整的独立地址空间（内存）；
2. 切换CPU，需要保存CPU环境（包括寄存器值、程序计数器、堆栈指针等），同时，修改内存管理单元（memory management unit，MMU）的寄存器，并将转换后备缓冲器（translation lookaside buffer, TLB)中地址转换缓存内容标为无效。此外，IPC操作，需要及进行用户空间与内核空间切换，需要多次盖面MMU，并刷新TLB。
3. 进程数超出主存能力，切换存在主存和磁盘交换。
    
相比较而言，**线程切换**，代价开销小：
1. 维护多个线程共享CPU所必需的最少量信息。
2. 应用人员控制并发。
3. 线程通信，可以通过共享数据完成，只在用户空间中执行。

## 线程实现
线程通过线程包方式提供，两种实现方法：
- 构造用户模式下执行的线程库；
    - 优点：用户模式下，线程生命周期管理开销小，线程上下文切换开销小；
    - 缺点：单个线程调用阻塞的系统调用，会阻塞整个进程。
- 内核管理线程并调度；
    - 优点：单线程阻塞不影响，整个进程执行情况；
    - 缺点：类似进程，生命周期管理需要在内核空间完成，开销大。

### 解决方案

# 设计思想
测试工具主要实现的目的是，通过模拟一定的负载访问被测试对象，并在测试过程中收集对应的指标，最后，对指标进行分析返回给用户，用户根据生成的报告作为依据，判断被测试对象的某些特性的好坏（性能、稳定性等）。根据测试工具实现的目的，本文将测试工具主要的运行流程，分为如下六步：

![](/images/tools/test-tools-pro.PNG)

1. 加载配置（初始化）：工具通过不同的方式（文件、命令行参数等）将一些配置（包含用户的自定义配置）加载到内存中，进行初始化的设置工作。
2. 连接测试对象：测试工具通过自定义的配置，连接到被测试的对象，往往是通过客户端模拟访问的方式进行连接；
3. 生成负载：测试工具针对不同的被测试对象，生成不同的测试负载，例如：数据库的数据库CRUD访问、网站的HTTP访问等；
4. 数据收集：这个过程一般是伴随着负载生成的过程，收集既定的指标，并将数据存储下来；
5. 数据分析：将前一步存储的指标数据进行计算，依据预先设立的评估方式，得出高层指标；
6. 生成报告：将高层指标汇集，通过用户定义的方式输出；

# 解决的问题
分析设计思想中的6步骤，基本涵盖了测试工具需要执行的流程，而每个步骤的实现都需要解决一些关键的问题，进行分析如下：
1. 加载配置，如何加载配置信息，一些工具往往会提供多种的配置方式；
2. 连接测试对象：测试工具往往不是支持单一的测试对象，是支持一系列相同类型的测试对象，那么，如何实现相同的流程支持多种测试对象？
3. 生成负载：生成负载的特性，往往和最后测试成果息息相关，而且需要满足不同的用户测试成果，那么，如何设计和实现负载的生成？
4. 数据收集：负载生成过程中的指标，往往是最底层的指标，例如：数据库的访问延时等，不同的指标收集的方式也不同；
5. 数据分析：通过底层指标计算高层指标，需要涉及到评估模型的设计；
6. 生成报告：根据不同用户的需求，考虑将最终的指标以不同的方式输出；


# YCSB实现方案
针对如上提出的问题，本文分析了YCSB源码，分析YCSB针对6步骤的对应的解决方案。

## 介绍
[YCSB](https://github.com/brianfrankcooper/YCSB)是一个针对衡量不同“key-value”形式(nosql数据库)和云的服务存储性能的工具。支持多种nosql数据库，同时，工具支持自定义的负载配置，以及可扩展的数据库支持。具体的安装和使用可以参考YCSB所在github的[wiki](https://github.com/brianfrankcooper/YCSB/wiki)说明。

## 初始化



## 连接测试对象





# Reference
# 简介
内容分布网络(Content Delivery Network)。
CDN = 镜像(Mirror) + 缓存(Cache) + 整体负载均衡(GSLB)。
## 目标
- 可扩展性（Scalability)，性能可扩展。
- 安全性(Security)。
- 可靠性、响应和执行(Reliability、Responsiveness和Performance)。
## 请求过程
![](/images/web/dns.PNG)
以下是简化过程(以下过程与上图无关)：
    1. 用户通过HTTP请求访问静态资源；
    2. 浏览器根据URL发送DNS域名解析请求，到LDNS；
    3. LDNS经过迭代式解析，将域名的解析权通过CNAME方式解析到CDN专用的DNS服务器；
    4. CDN的DNS服务器将CDN的全局负载均衡设备IP地址返回用户；
    5. CDN全局负载均衡设备根据用户IP地址，以及用户请求的内容URL，选择一台用户所属区域的区域负载均衡设备，向这台设备发起请求；
    6. 区域负载均衡设备会为用户选择一台合适的缓存服务器提供服务，选择的依据包括：根据用户IP地址，判断哪一台服务器距用户最近；根据用户所请求的URL中携带的内容名称，判断哪一台服务器上有用户所需内容；查询各个服务器当前的负载情况，判断哪一台服务器尚有服务能力。基于以上这些条件的综合分析之后，区域负载均衡设备会向全局负载均衡设备返回一台缓存服务器的IP地址；
    7. 全局负载均衡设备把服务器的IP地址返回给用户；
    8. 用户向缓存服务器发起请求，缓存服务器响应用户请求，将用户所需内容传送到用户终端。如果这台缓存服务器上并没有用户想要的内容，而区域均衡设备依然将它分配给了用户，进行回源。
    >回源，CDN中不存在请求内容，这台服务器就要向它的上一级缓存服务器请求内容，直至追溯到网站的源服务器，即源站，请求资源返回给用户并缓存。
# 负载均衡
通过负载均衡，解决单点失效问题，提高可扩展性（解决网络拥塞），提高资源响应效率。
- 链路负载均衡，DNS解析，
- 集群负载均衡
    - 硬件负载均衡：F5，效率高，费用高。
    - 软件负载均衡：成本低，效率低，结构复杂。
- 操作系统负载均衡

# CDN动态加速
CDN动态加速技术，CDN的DNS解析中通过动态链路探测寻找回源最好途径，然后通过DNS调度将所有请求调度到选定的这条路径上回源。

# CDN使用


# Reference
- 《深入分析Java Web 技术内幕》
-  https://www.zhihu.com/question/36514327
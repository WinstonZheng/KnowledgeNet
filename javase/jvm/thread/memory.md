# Java内存模型
Java内存模型（Java Memory Model, JMM）主要目标是定义程序中各个变量的访问规则，即在虚拟机中将变量存储到内存和从内存中取出变量这样的底层细节（实例字段、静态字段和构成数组对象元素，会产生竞争）。

Java内存模型屏蔽了各种硬件和操作系统的内存访问差异，提供访问的一致性，JDK1.5发布后，Java内存模型已经成熟和完善起来。

## 特征
- 原子性
- 可见性
- 有序性


## 内存划分
Java内存模型规定了所有变量都存储在主内存（Main Memory），每条线程有自己的工作内存（Work Memory，类似与处理器高速缓存），保存主内存副本拷贝（可能知识对象一个属性）。

- 主内存 -> JAVA堆
- 工作内存 -> JAVA栈

## 内存操作
主内存与工作内存之间具体操作协议（JSR-133弃用）
- lock（锁定），作用于主内存变量，将变量标识为一条线程独占状态；
- unlock（解锁），作用于主内存变量，将处于锁定状态的变量释放出来；
- read（读取），作用于主内存变量，将一个变量值从主内存传输到工作内存；
- load（载入）作用于工作内存变量，将read的值放置到工作内存变量副本；
- use（使用），作用于工作内存**，将变量传递给执行引擎，每当虚拟机遇到一个需要使用到变量的值的字节码时执行；
- assign（赋值），作用于工作内存**，将从执行引擎接到的值赋给工作内存变量，遇到赋值操作执行；
- store（存储），作用于工作内存**，将工作内存变量传递给主内存；
- write （写入），作用于主内存**，将store的变量放到主内存变量中。

### 基本执行规则
基础描述暂不提供（见《深入理解java虚拟机》），主要提供等效判断原则----先行发生原则（用于确定一个访问在并发环境下时安全的）。





### volatile规则
volatile是java并发最轻量级的同步机制。




